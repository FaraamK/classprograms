//part one of the assignment

CREATE TABLE DEPT
(DEPT_ID CHAR(4) NOT NULL,
BUDGET NUMBER(5),
LOCATION CHAR(20),
PRIMARY KEY (DEPT_ID));

SELECT COLUMN_NAME, DATA_TYPE, NULLABLE
FROM USER_TAB_COLUMNS
WHERE TABLE_NAME = 'DEPT'
ORDER BY COLUMN_ID;

CREATE TABLE EMP
(EMP_NO CHAR(5) NOT NULL,
DEPTID CHAR(4),
PRIMARY KEY (EMP_NO),
FOREIGN KEY (DEPTID) REFERENCES DEPT);

SELECT COLUMN_NAME, DATA_TYPE, NULLABLE
FROM USER_TAB_COLUMNS
WHERE TABLE_NAME = 'EMP'
ORDER BY COLUMN_ID;

SELECT CON.TABLE_NAME, CON.CONSTRAINT_NAME,
 CON.CONSTRAINT_TYPE,
 COL.COLUMN_NAME, COL.POSITION,
 CON.R_CONSTRAINT_NAME,
 CON.DELETE_RULE
FROM USER_CONSTRAINTS CON,
 USER_CONS_COLUMNS COL
WHERE CON.CONSTRAINT_NAME =
 COL.CONSTRAINT_NAME
ORDER BY 1, 2;

INSERT INTO DEPT (DEPT_ID, BUDGET, LOCATION)
VALUES ('HR', 11111, 'HARTFORD');
INSERT INTO DEPT (DEPT_ID, BUDGET, LOCATION)
VALUES ('QA', 99999, 'MANCHESTER');

SELECT *
FROM DEPT;

INSERT INTO EMP (EMP_NO, DEPTID)
VALUES ('E0011', 'QA');
INSERT INTO EMP (EMP_NO, DEPTID)
VALUES ('E0012', 'QC');
// This line creates an integrity error code, ORA-02291

DELETE
FROM DEPT
WHERE DEPT_ID = 'HR';

DROP TABLE EMP PURGE;

CREATE TABLE EMP
(EMP_NO CHAR(5) NOT NULL,
DEPTID CHAR(4),
PRIMARY KEY (EMP_NO),
FOREIGN KEY (DEPTID)
REFERENCES DEPT(DEPT_ID)
 ON DELETE CASCADE);
//creates new EMP table

SELECT CON.TABLE_NAME, CON.CONSTRAINT_NAME,
 CON.CONSTRAINT_TYPE,
 COL.COLUMN_NAME, COL.POSITION,
 CON.R_CONSTRAINT_NAME,
 CON.DELETE_RULE
FROM USER_CONSTRAINTS CON,
 USER_CONS_COLUMNS COL
WHERE CON.CONSTRAINT_NAME =
 COL.CONSTRAINT_NAME
ORDER BY 1, 2;

INSERT INTO EMP (EMP_NO, DEPTID)
VALUES ('E0011', 'HR');

SELECT *
FROM DEPT;
SELECT *
FROM EMP;

DELETE
FROM DEPT
WHERE DEPT_ID = 'HR';

SELECT *
FROM DEPT;

SELECT *
FROM EMP;

DROP TABLE EMP PURGE;
DROP TABLE DEPT PURGE;

SELECT TABLE_NAME
FROM USER_TABLES;
